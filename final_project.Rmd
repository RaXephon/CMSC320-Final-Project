---
title: "CMSC320 Final Project"
date: "5/19/2019"
name: "Shashwat Kapoor, Jin Ah Kang, Theresa Choi"
output: html_document
---

## Library

```{r setup, message=FALSE, warning=FALSE}
library(tidyr)
library(dplyr)
library(ggplot2)
library(tibble)
library(tidyverse)
library(askpass)
library(datasets)
library(leaflet)
```

```{r}
fiji_map <- leaflet(quakes) %>%
  addTiles() %>%
  setView(lng=178.0650, lat=-17.7134, zoom=9)
fiji_map
```

```{r fijiMark}

icons <- awesomeIcons(
  icon = 'fa-flag',
  library = 'fa',
)

rce_dist <- fiji_map %>% addAwesomeMarkers(lng = 178.0650, lat = -17.7134, icon = icons)
rce_dist
```

```{r}
rce_dist <- rce_dist %>%
  setView(lng=178.0650, lat=-17.7134, zoom=5) %>%
  addCircleMarkers(
    radius = ~ifelse(mag == mag, mag, mag),
    color = "red",
    fillOpacity = 0.3,
    stroke = FALSE
  )

rce_dist
```

```{r}
X=cbind(as_tibble(quakes)$long, as_tibble(quakes)$lat)
kde2d <- bkde2D(X, bandwidth=c(bw.ucv(X[,1]),bw.ucv(X[,2])))

x=kde2d$x1
y=kde2d$x2
z=kde2d$fhat
CL=contourLines(x , y , z)

quake_density <- fiji_map %>%
  setView(lng=178.0650, lat=-17.7134, zoom=5)

for (x in seq(1, length(CL))) {
  quake_density <- quake_density %>%
  addPolylines(CL[[x]]$x, CL[[x]]$y, color = "#8B0000", weight = 2) %>%
  addPolygons(CL[[x]]$x, CL[[x]]$y, fillColor = "red", stroke = FALSE)
}

quake_density
```
